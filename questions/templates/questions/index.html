<!DOCTYPE html>
<html lang="en">
  {% load static%}

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Question {{pk}}</title>
    <link rel="stylesheet" href="{%static 'style/questions.css'%}" />
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="{%static 'js/ace-editor/src-min/ace.js'%}"></script>
    <script src="{%static 'js/ace-editor/src-min/mode-javascript.js'%}"></script>
    <script src="{%static 'js/ace-editor/src-min/ext-language_tools.js'%}"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"
    ></script>
  </head>
  <body class="bg-dark">
    {%include 'navbar.html'%}
    <div class="page">
      <div class="questionDiv user-select-none">
        <div class="heading">
          <h1 style="display: inline">Question</h1>
          <h1 style="display: inline; padding-left: 5px" class="question_no">
            {{pk}}
          </h1>
        </div>
        <p id="question-el"></p>
      </div>
      <div class="editor-container">
        <div id="editor"></div>
      </div>

      <!-- <script src="{%static 'js/editor-console.js'%}"></script> -->
    </div>

    <div class="container-custom">
      <form method="POST" , id="form-el">
        {% csrf_token %}
        <textarea
          name="textarea"
          id="hiddenfield"
          cols="1"
          rows="1"
          style="visibility: hidden"
        ></textarea>
        <button class="submit-btn" role="button">Submit</button>
      </form>
    </div>
    <script src="{%static 'js/questions.js'%}"></script>

    <script>
            $(document).ready(function () {
              setInterval(function () {
                $.ajax({
                  type: "GET",
                  url: "{% url 'getquestions'%}",
                  success: function (response) {
                    let ques = response.question[parseInt({{pk}})-1].question ;
                    $('#question-el').text(ques);
                    // console.log($('#question-el').text())
                  },
                  error: function (response) {
                    console.log("An Error Occured ");
                  },
                });
              }, 100);
              $(function () {
              $(".submit-btn").on("click", function () {
                const userCode = codeEditor.getValue();
                $("#hiddenfield").val(userCode);
                // alert($("#hiddenfield").val());
                $("form#form-el").submit();
          });
      });
            });
    </script>
  </body>
</html>
